"use strict";var _extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n)){t[n]=e[n]}}}return t};(function(){Array.prototype.find=Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r,e=Object(this),n=e.length>>>0,i=arguments[1],o=0;n>o;o++)if(r=e[o],t.call(i,r,o,e))return r;return void 0});var t=[];var r={add:function a(n){if(!n||!n.name){throw"Please specify a state name";return}var i=e(n);if(i)i=n;else t.push(n);r.trigger("add",i);return this},remove:function u(e){var n=undefined;t=t.filter(function(t){if(t.name!=e)return t;else n=t});r.trigger("remove",n);return this},go:function f(t,n){if(!r.active||!t)return;var i=e(t);if(!i){throw"State '"+t+"' has not been configured";return}var a=t.split(".");a=a.map(function(t,r){if(r>0){return a.slice(0,r).join(".")+"."+t}else{return t}});a.forEach(function(t,r){if(r<a.length){var n=e(t);i=_extends({},n,i)}});if(typeof i.resolve=="function"){var u=i.resolve();if(typeof u.then=="function")u.then(function(){return o(i,n)})}else{o(i,n)}return this},start:function s(){r.active=true;if(window.location.hash){var t=n(window.location.hash.replace("#!/",""));if(t)r.go(t.name)}window.addEventListener("popstate",i);r.trigger("start");return this},stop:function c(){r.active=false;window.removeEventListener("popstate",i);r.trigger("stop");return this},current:undefined,active:false};function e(r){return t.find(function(t){return t.name==r})}function n(r){return t.find(function(t){return t.url==r})}function i(t){if(t.state)r.go(t.state,true)}function o(t,e){if(typeof history.pushState!="undefined"&&t.history!=false){if(!history.state||history.state.name!=t.name&&!e){var n=t.hasOwnProperty("url")?"#!/"+t.url:null;history.pushState(t.name,null,n)}}var i=r.current;r.current=t;r.trigger("go",t,i)}riot.observable(r);riot.mixin("rg.router",{init:function l(){var t=this;this.router.on("go",function(){return t.update()})},router:r});if(!window.rg)window.rg={};window.rg.router=r})();