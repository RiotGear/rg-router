"use strict";var _extends=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var e in n){if(Object.prototype.hasOwnProperty.call(n,e)){r[e]=n[e]}}}return r};(function(){Array.prototype.find=Array.prototype.find||(Array.prototype.find=function(r){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof r)throw new TypeError("predicate must be a function");for(var t,n=Object(this),e=n.length>>>0,i=arguments[1],a=0;e>a;a++)if(t=n[a],r.call(i,t,a,n))return t;return void 0});var r=[];var t={hash:"#!",add:function u(e){if(!e||!e.name){throw"Please specify a state name";return}var i=n(e);if(i)i=e;else{if(e.url&&e.url[0]=="/")e.url=e.url.substr(1);r.push(e)}t.trigger("add",i);return this},remove:function f(n){var e=undefined;r=r.filter(function(r){if(r.name!=n)return r;else e=r});t.trigger("remove",e);return this},go:function s(r,e,i){if(!t.active||!r)return;var o=n(r);if(!o){throw"State '"+r+"' has not been configured";return}if(e)o.params=e;var u=r.split(".");u=u.map(function(r,t){if(t>0){return u.slice(0,t).join(".")+"."+r}else{return r}});u.forEach(function(r,t){if(t<u.length){var e=n(r);o=_extends({},e,o)}});if(typeof o.resolve=="function"){var f=o.resolve();if(typeof f.then=="function")f.then(function(){return a(o,i)})}else{a(o,i)}return this},start:function c(){t.active=true;if(window.location.hash){var r=e(window.location.hash.replace(t.hash+"/",""));if(r)t.go(r.name)}else if(t.hash===""){var n=e(window.location.pathname.slice(1));if(n)t.go(n.name)}window.addEventListener("popstate",i);t.trigger("start");return this},stop:function l(){t.active=false;window.removeEventListener("popstate",i);t.trigger("stop");return this},current:undefined,active:false};function n(t){return r.find(function(r){return r.name==t})}function e(t){var n=r.find(function(r){return r.url==t});if(n)return n;return r.find(function(r){if(!r.url)return false;var n=r.url.split("/");var e=t.split("/");r.params=r.params||{};for(var i=0;i<n.length;i++){var a=n[i];var o=e[i];if(a[0]==":"){r.params[a.substr(1)]=o}else if(a!=o){return false}}return true})}function i(r){if(r.state){var n=JSON.parse(r.state,function(r,t){if(t&&typeof t==="string"&&t.substr(0,8)=="function"){var n=t.indexOf("{")+1;var e=t.lastIndexOf("}");var i=t.indexOf("(")+1;var a=t.indexOf(")");return new Function(t.substring(i,a),t.substring(n,e))}return t});t.go(n.name,n.params,true)}}function a(r,n){if(typeof history.pushState!="undefined"&&r.history!=false){if(!history.state||!n){var e=JSON.stringify(r,function(r,t){if(typeof t==="function"){return t.toString()}return t});history.pushState(e,null,o(r))}}var i=t.current;t.current=r;t.trigger("go",r,i)}function o(r){if(r.params){var n=r.url.split("/");var e=n.map(function(t){if(t[0]!=":")return t;return r.params[t.substr(1)]}).filter(function(r){return r?true:false}).join("/");return t.hash+"/"+e}return r.hasOwnProperty("url")?t.hash+"/"+r.url:null}riot.observable(t);riot.mixin("rg.router",{init:function p(){var r=this;this.router.on("go",function(){return r.update()})},router:t});if(!window.rg)window.rg={};window.rg.router=t})();